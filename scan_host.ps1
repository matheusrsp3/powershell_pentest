# scan_host.ps1 - Escanear dispositivos na rede
#
# Autor     : Matheus Rodrigues - (mcarvalho)
# Manutenção: Matheus Rodrigues - (mcarvalho)
# Contato   : matheusrsp3@gmail.com
#
# ---------------------------------------------------------------------------------------
# Descrição do programa:
#   Programa tem a função de escanear uma rede e informar ao usuário se dentro do range de
#   0-255 quais host's estão UP naquela rede
# 
# Exemplos:
#   $ .\scan_host.ps1
#
# ---------------------------------------------------------------------------------------
# Histórico:
#   v1.0 17/08/2023, Matheus Rodrigues
#   Inicio do programa
#
# ---------------------------------------------------------------------------------------
# Testado:
#    Sistema Operacional - Windows 10 22H2
#    Arquitetura         - 64-bit
#    Versão PowerShell   - 5.1.19041.2673
#
# ---------------------------------- Variaveis Globais ----------------------------------
$ErrorActionPreference = "SilentlyContinue"
$padraoDeRede = "^([0-9]{1,3}\.){2}[0-9]{1,3}$"

# --------------------------------- Execução do Programa ---------------------------------
do {
    $redeParaEscanear = Read-Host "Informe a rede no seguinte formato <xxx.xxx.xxx>: "
    if ( $redeParaEscanear -match "[a-zA-Z]" ) {
        Write-Output "Insira somente numeros para a rede!"
    }
} while ( $redeParaEscanear -notmatch $padraoDeRede )

for ($i=0; $i -le 255; $i++) {

    if ( Test-Connection -ComputerName "$redeParaEscanear.$i" -Count 1 ) {
        Write-Host "Host [UP] - $redeParaEscanear.$i"
    } else {
        Write-Host "Host [DOWN] - $redeParaEscanear.$i"
    }
}
